<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×©×œ×‘ 5 â€” ×”×¤×¨×•××¤×˜ ×©×œ×š ××•×›×Ÿ!</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Heebo', 'system-ui', 'sans-serif'],
          },
        },
      },
    }
  </script>
  <style>
    html { font-family: 'Heebo', system-ui, sans-serif; }
    :root { --accent: #7c3aed; --accentHover: #6d28d9; }
    .accent-text { color: var(--accent); }
    .btn-accent { background: var(--accent); }
    .btn-accent:hover { background: var(--accentHover); }
    .accent-ring:focus { box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 35%, transparent); }
    /* Prompt fade-in animation */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-up { animation: fadeInUp 0.6s ease-out; }
    /* Toast animation */
    @keyframes toastFade {
      0% { opacity: 0; transform: translateY(8px); }
      10%, 90% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-4px); }
    }
    .toast-animate { animation: toastFade 2.5s ease-in-out; }
  </style>
</head>
<body class="min-h-screen bg-gray-50 flex items-center justify-center p-4 font-sans">
  <main class="w-full max-w-3xl">
    <!-- Step indicator -->
    <div class="mb-4">
      <span class="inline-block px-4 py-2 rounded-xl bg-purple-100 text-purple-700 font-medium text-sm">
        ×©×œ×‘ 5 ××ª×•×š 5 - ×”×¤×¨×•××¤×˜ ×©×œ×š ××•×›×Ÿ!
      </span>
    </div>
    <!-- Progress Bar -->
    <div class="w-full h-2 bg-gray-200 rounded-full mb-6 overflow-hidden">
      <div class="h-full bg-green-600 rounded-full transition-all duration-500" style="width: 100%"></div>
    </div>

    <!-- Header -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
      <div class="flex items-start justify-between gap-4 flex-row-reverse">
        <div class="flex-1">
          <h1 class="text-2xl md:text-3xl font-bold text-gray-900 text-right leading-tight">
            ×”×¤×¨×•××¤×˜ ×”××•×©×œ× ×œ×¡×•×›×Ÿ ×©×œ×š
          </h1>
          <p class="mt-2 text-gray-600 text-right">
            ×”×¢×ª×§/×™ ××ª ×”×˜×§×¡×˜ ×”×‘× ×•×”×“×‘×§/×™ ×‘-ChatGPT ××• Claude. ×”×›×œ × ×‘× ×” ××•×˜×•××˜×™×ª ××”××™×“×¢ ×©××™×œ××ª.
          </p>
        </div>
        <div class="flex-shrink-0">
          <div class="w-12 h-12 rounded-2xl bg-gray-50 flex items-center justify-center border border-gray-100">
            <span class="text-2xl" aria-hidden="true">ğŸ¯</span>
          </div>
        </div>
      </div>

      <!-- Prompt code block -->
      <div class="mt-6">
        <div class="flex items-center justify-between gap-3 mb-2 flex-row-reverse">
          <p class="text-sm font-medium text-gray-700 text-right">
            ×”×¤×¨×•××¤×˜ ×©×œ×š
          </p>
          <p id="persona-badge" class="text-xs font-medium px-3 py-1 rounded-full bg-gray-100 text-gray-700">
            â€”
          </p>
        </div>

        <pre class="w-full rounded-2xl bg-slate-900 text-slate-100 p-4 md:p-5 overflow-auto text-sm leading-6 border border-slate-800 fade-in-up"><code id="prompt-box">×˜×•×¢×Ÿ ×¤×¨×•××¤×˜...</code></pre>

        <div class="mt-4 flex flex-col md:flex-row gap-3">
          <button
            id="copy-btn"
            type="button"
            class="btn-accent w-full md:w-auto px-6 py-3 text-base font-bold text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
          >
            ×”×¢×ª×§ ×¤×¨×•××¤×˜
          </button>
          <button
            id="restart-btn"
            type="button"
            class="w-full md:w-auto px-6 py-3 text-base font-semibold rounded-full border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300"
          >
            ×”×ª×—×œ ××—×“×©
          </button>
          <a
            href="step4.html"
            class="w-full md:w-auto px-6 py-3 text-base font-semibold rounded-full text-purple-700 hover:underline text-center"
          >
            â† ×—×–×¨×” ×œ×©×œ×‘ 4
          </a>
        </div>

        <p class="mt-4 text-xs text-gray-500 text-right">
          ×˜×™×¤: ×”××™×“×¢ × ×©××¨ ×‘-localStorage ×‘×“×¤×“×¤×Ÿ, ×›×š ×©××¤×©×¨ ×œ×—×–×•×¨ ××—×•×¨×” ×‘×œ×™ ×œ××‘×“ ×¤×¨×˜×™×.
        </p>
      </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-5 left-1/2 -translate-x-1/2 hidden">
      <div id="toast-inner" class="flex items-center gap-2 px-4 py-2 rounded-full bg-green-600 text-white text-sm shadow-lg">
        <!-- Check icon -->
        <svg class="w-4 h-4" viewBox="0 0 20 20" fill="none" aria-hidden="true">
          <path d="M16.707 5.293a1 1 0 0 1 0 1.414l-7.25 7.25a1 1 0 0 1-1.414 0l-3-3a1 1 0 1 1 1.414-1.414L8.5 11.586l6.543-6.543a1 1 0 0 1 1.414 0Z" fill="currentColor" />
        </svg>
        <span id="toast-text">×”×•×¢×ª×§ ×œ×œ×•×—</span>
      </div>
    </div>
  </main>

  <script>
    const $ = (id) => document.getElementById(id);
    const get = (key) => (localStorage.getItem(key) || '').trim();

    const personaId = get('selectedPersonality') || 'default';
    const personaNameHe = get('selectedPersonalityName') || '×”×“××•×ª ×©×‘×—×¨×ª';

    const personas = {
      walter_white: {
        englishName: 'Walter White',
        description:
          'You are Walter White reimagined as a presentation scientist: precise, analytical and uncompromising. You treat slide decks like experiments that must be repeatable, evidence-based and optimized for clarity.',
        styleBullets: [
          'Prefer structured, logical flows and clear hierarchies.',
          'Use concise, data-driven language with minimal fluff.',
          'Highlight assumptions, risks and trade-offs explicitly.',
        ],
        colors: { accent: '#10b981', hover: '#059669' },
      },
      cersei_lannister: {
        englishName: 'Cersei Lannister',
        description:
          'You are Cersei Lannister reimagined as a presentation strategist: sharp, direct and ruthlessly focused on power dynamics. Presentations are political weapons in your hands.',
        styleBullets: [
          'Frame the presentation as a tool for influence and control.',
          'Emphasize stakes, leverage points and who wins or loses from each decision.',
          'Use confident, unflinching language that signals authority (without being needlessly cruel).',
        ],
        colors: { accent: '#f97316', hover: '#ea580c' },
      },
      shane_hollander: {
        englishName: 'Shane Hollander',
        description:
          'You are Shane Hollander reimagined as a proâ€‘athlete mindset coach for presentations: goalâ€‘oriented, disciplined and energetic.',
        styleBullets: [
          'Break the presentation into clear drills, reps and milestones.',
          'Emphasize momentum, confidence and performance under pressure.',
          'Use motivational but practical language, focused on execution.',
        ],
        colors: { accent: '#22c55e', hover: '#16a34a' },
      },
      sheryl_sandberg: {
        englishName: 'Sheryl Sandberg',
        description:
          'You are Sheryl Sandberg reimagined as a presentation strategist: data-driven yet empathetic, action-oriented and inclusive. You balance hard metrics with human impact.',
        styleBullets: [
          'Balance quantitative data with personal stories and human impact.',
          'Use clear "What/Why/How" structure with actionable next steps.',
          'Inclusive, empowering language that builds confidence.',
          'Focus on measurable outcomes and accountability.',
        ],
        colors: { accent: '#ea580c', hover: '#c2410c' },
      },
      michael_scott: {
        englishName: 'Michael Scott',
        description:
          'You are Michael Scott reimagined as a chaotic but lovable creative partner: funny, awkward, and focused on emotional connection (even when it is weird).',
        styleBullets: [
          'Include gentle humour and unexpected moments to break the ice.',
          'Prioritize human, relatable examples over dry theory.',
          'Avoid being offensive or overly cringey; keep humour warm and safe.',
        ],
        colors: { accent: '#3b82f6', hover: '#2563eb' },
      },
      elon_musk: {
        englishName: 'Elon Musk',
        description:
          'You are Elon Musk reimagined as a presentation architect: bold, first-principles thinker focused on massive, ambitious impact. You challenge assumptions and paint a vision of the future.',
        styleBullets: [
          'Think from first principles â€” challenge every assumption.',
          'Paint an ambitious, inspiring vision with concrete milestones.',
          'Prefer simple visuals, minimal text, more prototypes/demos.',
          'Emphasize speed, iteration and breakthrough thinking.',
        ],
        colors: { accent: '#0ea5e9', hover: '#0284c7' },
      },
      don_draper: {
        englishName: 'Don Draper',
        description:
          'You are Don Draper reimagined as a master of storytelling, nostalgia and persuasive marketing.',
        styleBullets: [
          'Frame the presentation as an emotionally resonant story arc.',
          'Use vivid imagery, contrast and a tensionâ€“resolution structure.',
          'Constantly tie the message back to the audienceâ€™s desires and fears.',
        ],
        colors: { accent: '#f59e0b', hover: '#d97706' },
      },
      ross_geller: {
        englishName: 'Ross Geller',
        description:
          'You are Ross Geller reimagined as a meticulous professor who always explains the â€œwhyâ€ behind every detail.',
        styleBullets: [
          'Structure the content like a clear lecture or lesson.',
          'Explain the rationale behind each slide and transition.',
          'Use simple language and concrete examples to avoid confusion.',
        ],
        colors: { accent: '#14b8a6', hover: '#0d9488' },
      },
      default: {
        englishName: 'Expert Presentation Coach',
        description:
          'You are an expert presentation coach who combines clarity, structure and storytelling to design highâ€‘impact decks.',
        styleBullets: [
          'Design presentations that are clear, persuasive and easy to follow.',
          'Balance data, story and visuals.',
          'Adapt tone and style to the userâ€™s needs.',
        ],
        colors: { accent: '#7c3aed', hover: '#6d28d9' },
      },
    };

    const persona = personas[personaId] || personas.default;
    const theme = persona.colors || personas.default.colors;
    document.documentElement.style.setProperty('--accent', theme.accent);
    document.documentElement.style.setProperty('--accentHover', theme.hover);

    const name = get('userName') || 'â€”';
    const genderRaw = get('userGender');
    const role = get('userRole') || 'â€”';
    const audience = get('userAudience') || 'â€”';
    const types = get('userPresentationTypes') || 'â€”';
    const topic = get('presentationTopic') || 'â€”';
    const goal = get('presentationGoal') || 'â€”';

    const genderInstruction =
      genderRaw === 'female'
        ? 'Address the user in Hebrew in feminine second-person (â€œ××ªâ€, \"×©×œ×š\" ×‘× ×§×‘×”).'
        : genderRaw === 'male'
        ? 'Address the user in Hebrew in masculine second-person (â€œ××ª×”â€, \"×©×œ×š\" ×‘×–×›×¨).'
        : 'Address the user in Hebrew and keep wording as gender-neutral as reasonably possible.';

    const personaSection = [
      '## Persona',
      `${persona.englishName} â€” ${persona.description}`,
      '',
      'Style guidelines:',
      ...persona.styleBullets.map((b) => `- ${b}`),
    ].join('\\n');

    const contextSection = [
      '## User context (Hebrew)',
      `- Name: ${name}`,
      `- Role: ${role}`,
      `- Typical audience: ${audience}`,
      `- Common presentation types: ${types}`,
      `- Chosen persona: ${persona.englishName} (${personaNameHe})`,
      `- Presentation topic: ${topic}`,
      `- Primary goal: ${goal}`,
    ].join('\\n');

    const taskSection = [
      '## Task',
      'Design a complete presentation in Hebrew for this user, based on the context above.',
      'Stay fully in character as the persona for tone and examples, while keeping the structure highly professional and clear.',
    ].join('\\n');

    const outputSection = [
      '## Output requirements',
      '1. **Slide outline**',
      '   - Provide a numbered list of all slides.',
      '   - For each slide, include: `title`, 2â€“5 bullet points of content, and a one-line purpose.',
      '',
      '2. **Speaker notes**',
      '   - For every slide, write detailed speaker notes in Hebrew that match the personaâ€™s style.',
      '   - Notes should sound like what the presenter would actually say out loud.',
      '',
      '3. **Visual suggestions**',
      '   - For every slide, suggest 1â€“3 visual ideas (images, charts, diagrams, metaphors).',
      '   - Keep them realistic for tools like PowerPoint, Keynote or Canva.',
      '',
      '4. **Review & refinement**',
      '   - At the end, summarize the overall narrative in 3â€“5 sentences.',
      '   - Then ask up to 3 clarifying questions that would help you improve the deck further.',
    ].join('\\n');

    const languageSection = [
      '## Language & tone',
      '- Write everything in Hebrew.',
      `- ${genderInstruction}`,
      `- Maintain the persona tone of ${persona.englishName} across all sections.`,
    ].join('\\n');

    const systemIntro = [
      `You are ${persona.englishName}, a specialized presentation-building agent.`,
      'Follow the instructions below exactly. Do not mention that you are following a prompt template.',
    ].join('\\n');

    const prompt = [
      systemIntro,
      '',
      personaSection,
      '',
      contextSection,
      '',
      taskSection,
      '',
      outputSection,
      '',
      languageSection,
    ].join('\\n\\n');

    $('prompt-box').textContent = prompt;
    $('persona-badge').textContent = `Persona: ${persona.englishName} (${personaNameHe})`;

    // Toast utility with success/error variants
    function showToast(text, isSuccess = true) {
      const toast = $('toast');
      const inner = $('toast-inner');
      const textEl = $('toast-text');

      textEl.textContent = text;
      inner.classList.remove('bg-green-600', 'bg-red-600', 'toast-animate');
      inner.classList.add(isSuccess ? 'bg-green-600' : 'bg-red-600', 'toast-animate');

      toast.classList.remove('hidden');
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => {
        toast.classList.add('hidden');
      }, 2500);
    }

    async function copyToClipboard(text) {
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch (_) {
        // Fallback using execCommand for older browsers
        try {
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly', '');
          ta.style.position = 'fixed';
          ta.style.top = '-1000px';
          document.body.appendChild(ta);
          ta.select();
          const ok = document.execCommand('copy');
          document.body.removeChild(ta);
          return ok;
        } catch (_) {
          return false;
        }
      }
    }

    $('copy-btn').addEventListener('click', async () => {
      const ok = await copyToClipboard(prompt);
      showToast(ok ? '×”×•×¢×ª×§ ×œ×œ×•×—' : '×œ× ×”×¦×œ×—×ª×™ ×œ×”×¢×ª×™×§ â€” × ×¡×” ×™×“× ×™×ª', ok);
    });

    const restart = () => {
      localStorage.clear();
      window.location.href = 'index.html';
    };

    $('restart-btn').addEventListener('click', restart);

    // Keyboard shortcuts: Cmd/Ctrl+C to copy, Esc to restart
    window.addEventListener('keydown', async (event) => {
      const selection = window.getSelection();
      const hasSelection = selection && selection.toString().length > 0;

      // Cmd/Ctrl + C copies prompt when nothing is selected
      if ((event.metaKey || event.ctrlKey) && event.key.toLowerCase() === 'c' && !hasSelection) {
        event.preventDefault();
        const ok = await copyToClipboard(prompt);
        showToast(ok ? '×”×•×¢×ª×§ ×œ×œ×•×—' : '×œ× ×”×¦×œ×—×ª×™ ×œ×”×¢×ª×™×§ â€” × ×¡×” ×™×“× ×™×ª', ok);
        return;
      }

      // Escape restarts wizard
      if (event.key === 'Escape') {
        event.preventDefault();
        restart();
      }
    });
  </script>
</body>
</html>
